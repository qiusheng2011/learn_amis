<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8" />
  <title>amis demo</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <link rel="stylesheet" href="antd.css" />
  <link rel="stylesheet" href="helper.css" />
  <link rel="stylesheet" href="iconfont.css" />
  <!-- 这是默认主题所需的，如果是其他主题则不需要 -->
  <!-- 从 1.1.0 开始 sdk.css 将不支持 IE 11，如果要支持 IE11 请引用这个 css，并把前面那个删了 -->
  <!-- <link rel="stylesheet" href="sdk-ie11.css" /> -->
  <!-- 不过 amis 开发团队几乎没测试过 IE 11 下的效果，所以可能有细节功能用不了，如果发现请报 issue -->
  <style>
    html,
    body,
    .app-wrapper {
      position: relative;
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>

<body>
  <div id="root" class="app-wrapper"></div>
  <script src="sdk.js"></script>
  <script type="text/javascript">
    (function () {
      let amis = amisRequire("amis/embed");
      // 通过替换下面这个配置来生成不同页面
      let amisJSON = {
        type: "page",
        title: "demo",
        toolbar: [
          {
            type: "form",
            mode: "inline",
            pageClassName: "mb-0",
            title: "toolbar2",
            data: {
              type: "<h1>(出入境)</h1>",
              a: 2
            },
            intiApi: "http://39.105.97.149:8090/mock/57/demo/persons?a=${select_type}",
            body: [
              {
                type: "select",
                label: "提交${a==1? 'AAA':'BBB'}类型${type|raw}",
                name: "select_type",
                mode: "inline",
                options: [
                  {
                    label: "出国申请单",
                    value: "1"
                  },
                  {
                    label: "入境申请单",
                    value: "2"
                  },
                  {
                    label: "名单",
                    value: 3
                  }
                ]
              }
            ]
          }
        ],
        body: [
          {
            type: "tpl",
            tpl: "tpl_demoddd"
          },
          {
            type: "form",
            title: "搜索条件",
            mode: "inline",
            submitText: "搜索",
            target: "demo_crud",
            body: [
              {
                label: "姓名",
                type: "input-text",
                name: "name",
              }
            ],
          },
          {
            disabledOn: "${ select_type == 3}",
            type: "service",
            body: [
              {

                type: "crud",
                "syncLocation": false,
                api: {
                  metchod: "get",
                  url: 'http://39.105.97.149:8090/mock/57/demo/persons',
                  data: {
                    page_num: "${page}",
                    page_size: "${perPage}",
                    idcard: "$idcard",
                    gender: "$gender",
                    nane: "$name"

                  },
                  responseData:{
                    total: "$rst.total",
                    items: "$rst.data",
                    pageNo:"$rst.page_num",
                    pageSize:"$rst.page_size"
                  }
                },
                name: "demo_crud",
                title: "赞助人名单($rst.total)",
                syncLocation: false,
                footerToolbar: [
                  "pagination",
                  "switch-per-page"
                ],
               // source: "$rst.data",
                filter: {
                  title: "筛选",
                  body: [
                    {
                      label: "ID",
                      type: "input-text",
                      name: "id",
                    },
                    {
                      label: "姓名",
                      type: "input-text",
                      name: "name"
                    },
                    {
                      label: "性别",
                      type: "select",
                      name: "gender",
                      options: [
                        "男",
                        "女"
                      ]
                    },
                    {
                      label: "城市地区",
                      type: "input-text",
                      name: "city_county",
                    }
                  ]
                },
                columns: [
                  {
                    name: "idcard",
                    label: "<h3>ID</h3>"
                  },
                  {
                    name: "name",
                    label: "<h3>姓名</h3>"
                  },
                  {
                    name: "gender",
                    label: "性别"
                  },
                  {
                    name: '${(birthday)}',
                    label: '生日'
                  },
                  {
                    name: "${CONCATENATE(city, county)}",
                    label: "城市-地区"
                  },
                  {
                    name: "${LEFT(description,10)}",
                    label: '介绍'
                  }

                ]
              }


            ]
          },
        ],
      };
      let amisScoped = amis.embed("#root", amisJSON, {}, { theme: "antd" });

    })();
  </script>
</body>

</html>